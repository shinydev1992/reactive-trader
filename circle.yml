machine:
  node:
    version: 5.1.0
  services:
    - docker

dependencies:
  cache_directories:
    - ~/.npm
  override:
    - docker info
    - echo "pull base containers"
    - . ./deploy/config && docker pull $nginxContainer
    - . ./deploy/config && docker pull $crossbarContainer
    - . ./deploy/config && docker pull $monoContainer
    - . ./deploy/config && docker pull $eventstoreContainer

test:
  override:
    - chmod 755 deploy/docker/build/prepare
    - chmod 755 deploy/docker/build/servers/build.sh
    - cd deploy/docker/build && ./prepare build servers
    - cd src/client && npm install
    - cd src/client && npm run compile
